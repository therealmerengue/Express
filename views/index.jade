extends layout

block content
  #wrapper
    #sidenav-wrapper
        nav.sidenav
            ul.sidenav-list
                li.sidenav-list-item
                    a(href="#d1", data-toggle="tooltip", title="Change style", data-placement="right"): i(class="fa fa-database")
                li.sidenav-list-item
                    a(href="#d2", data-toggle="tooltip", title="Vehicle list", data-placement="right"): i(class="fa fa-user-plus")
                li.sidenav-list-item
                    a(href="#d3"): i(class="fa fa-user-plus")

    #page-content-wrapper
        #d1
            .btn-group-vertical(data-toggle='buttons')
                label.btn.btn-default.disabled
                    input(type='radio', name='options', autocomplete='off', disabled='true')
                    |  Style:
                label.btn.btn-primary.active
                    img(src="images/App.png")
                    input#style(type='radio', name='options', autocomplete='off', checked='')
                    |  App
                label.btn.btn-primary
                    img(src="images/Basic.png")
                    input#basic(type='radio', name='options', autocomplete='off')
                    |  Basic
                label.btn.btn-primary
                    img(src="images/Light.png")
                    input#light(type='radio', name='options', autocomplete='off')
                    |  Light
                label.btn.btn-primary
                    img(src="images/Dark.png")
                    input#dark(type='radio', name='options', autocomplete='off')
                    |  Dark
                label.btn.btn-primary
                    img(src="images/Street.png")
                    input#street(type='radio', name='options', autocomplete='off')
                    |  Street

        #d2
            form(role='form')
                .form-group
                    input#searchinput.form-control(type='search', placeholder='Search...')
                #searchlist.list-group
                    for point in points
                        a.list-group-item.vehicle(href='#')
                            span= point.properties.plate
            script.
                $('#searchlist').btsListFilter('#searchinput', {itemChild: 'span'});

        #d3
            .table-responsive-vertical.shadow-z-1
                // Table starts here
                table#table.table.table-hover.table-mc-light-blue
                    thead
                        tr
                            th Plate
                            th Name
                            th Coords
                            th Speed
                            th Distance
                            th Last update
                    tbody
                        for point in points
                            tr
                                td(data-title='Plate')= point.properties.plate
                                td(data-title='Name')= point.properties.title
                                td(data-title='Coords')= point.geometry.coordinates
                                td(data-title='Speed')= point.properties.speed
                                td(data-title='Distance')= point.properties.distance
                                td(data-title='Last update')= point.properties.date

        #map

        #historyModal.modal(data-easein='fadeIn', tabindex='-1', role='dialog', aria-labelledby='myModalLabel', aria-hidden='false')
            .modal-dialog
                .modal-content
                    .modal-header
                        button.close(type='button', data-dismiss='modal', aria-hidden='true') Ã—
                        h4#myModalLabel.modal-title Speed changes
                    .modal-body
                        canvas#speedChart(width='200', height='200')
                        canvas#distanceChart(width='200', height='200')
                    .modal-footer
                        button.btn.btn-default(data-dismiss='modal', aria-hidden='true') Close
                        button.btn.btn-primary Save changes

        script(type='text/javascript').
            var bounds = [
                [-185.0, -85.0], // Southwest coordinates
                [185.0, 85.0]  // Northeast coordinates
            ];
            var map = getMap({
                container: 'map',
                center: [0, 0],
                zoom: 2.01,
                bearing: 0,
                pitch: 0,
                minZoom: 2,
                style: '/styles/style.json',
                maxBounds: bounds
            }, !{JSON.stringify(points)});

            $.periodic({period: 10000, decay: 1, max_period: 60000}, function() {
                $.ajax({
                    url: '/update',
                    success: function(data) {
                        movePointsAnimated(data, map);
                    },
                    complete: this.ajax_complete,
                    dataType: 'json'
                });
            });